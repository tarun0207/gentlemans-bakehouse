<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard | Gentleman's Bakehouse</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600;700&family=Playfair+Display:wght@400;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/admin.css">
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
</head>

<body>
    <!-- Login Screen -->
    <div id="login-screen" class="login-container">
        <div class="login-box">
            <img src="./assets/logo.jpg" alt="Logo" class="admin-logo">
            <h2>Admin Login</h2>
            <form id="login-form">
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="admin-email" placeholder="admin@gentlemansbakehouse.com" required>
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="admin-password" placeholder="••••••••" required>
                </div>
                <button type="submit" class="btn-primary full-width">Login to Dashboard</button>
            </form>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div id="dashboard-app" class="dashboard-container" style="display: none;">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="brand">
                <h3>Gentleman's<br>Bakehouse</h3>
            </div>
            <nav class="sidebar-nav">
                <a href="#" class="active" onclick="switchView('overview')"><i class="fas fa-home"></i> Dashboard</a>
                <a href="#" onclick="switchView('orders')"><i class="fas fa-shopping-bag"></i> Orders</a>
                <a href="#" onclick="switchView('inventory')"><i class="fas fa-boxes"></i> Inventory</a>
                <a href="#" onclick="switchView('products')"><i class="fas fa-cookie"></i> Products</a>
                <a href="#" onclick="switchView('corporate')"><i class="fas fa-building"></i> Corporate Orders</a>
                <a href="#" onclick="switchView('customers')"><i class="fas fa-users"></i> Customers</a>
                <a href="#" onclick="switchView('settings')"><i class="fas fa-cog"></i> Settings</a>
            </nav>
            <div class="logout-area">
                <button onclick="logout()" class="btn-outline"><i class="fas fa-sign-out-alt"></i> Logout</button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Overview Section -->
            <section id="view-overview" class="view-section">
                <h2>Dashboard Overview</h2>
                <div class="kpi-grid">
                    <div class="kpi-card">
                        <i class="fas fa-shopping-cart"></i>
                        <h3 id="kpi-orders">0</h3>
                        <p>Today's Orders</p>
                    </div>
                    <div class="kpi-card">
                        <i class="fas fa-rupee-sign"></i>
                        <h3 id="kpi-revenue">₹0</h3>
                        <p>Today's Revenue</p>
                    </div>
                    <div class="kpi-card">
                        <i class="fas fa-clock"></i>
                        <h3 id="kpi-pending">0</h3>
                        <p>Pending Orders</p>
                    </div>
                    <div class="kpi-card">
                        <i class="fas fa-exclamation-triangle"></i>
                        <h3 id="kpi-low-stock">0</h3>
                        <p>Low Stock Items</p>
                    </div>
                </div>

                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <h3>Today's Bake List</h3>
                        <div id="bake-list" class="bake-list">Loading...</div>
                    </div>
                    <div class="dashboard-card">
                        <h3>Recent Orders</h3>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Order ID</th>
                                    <th>Customer</th>
                                    <th>Amount</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="recent-orders-body">
                                <tr>
                                    <td colspan="4" class="empty-cell">Loading...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Orders Section -->
            <section id="view-orders" class="view-section" style="display:none;">
                <h2>Order Management</h2>
                <div class="filter-bar">
                    <select id="order-status-filter">
                        <option value="all">All Orders</option>
                        <option value="pending">Pending</option>
                        <option value="confirmed">Confirmed</option>
                        <option value="production">In Production</option>
                        <option value="dispatched">Dispatched</option>
                        <option value="completed">Completed</option>
                    </select>
                    <input type="date" id="order-date-filter">
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Order ID</th>
                            <th>Date</th>
                            <th>Customer</th>
                            <th>Items</th>
                            <th>Total</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="orders-table-body">
                        <tr>
                            <td colspan="7" class="empty-cell">Loading orders...</td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <!-- Products Section -->
            <section id="view-products" class="view-section" style="display:none;">
                <div class="section-header">
                    <h2>Product Catalog</h2>
                    <button class="btn-primary" onclick="openProductModal()"><i class="fas fa-plus"></i> Add
                        Product</button>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Product Name</th>
                            <th>Category</th>
                            <th>Price</th>
                            <th>Stock</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="products-table-body">
                        <tr>
                            <td colspan="6" class="empty-cell">Loading products...</td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <!-- Inventory Section -->
            <section id="view-inventory" class="view-section" style="display:none;">
                <div class="section-header">
                    <h2>Inventory Management</h2>
                    <button class="btn-primary" onclick="openInventoryModal('ingredients')"><i class="fas fa-plus"></i>
                        Add Item</button>
                </div>

                <div class="inventory-summary">
                    <div class="summary-pill" id="low-stock-ingredients" style="display:none;">
                        <i class="fas fa-exclamation-triangle"></i>
                        <span id="count-low-ing">0</span> Low Stock Ingredients
                    </div>
                    <div class="summary-pill" id="low-stock-packaging" style="display:none;">
                        <i class="fas fa-exclamation-triangle"></i>
                        <span id="count-low-pack">0</span> Low Stock Packaging
                    </div>
                </div>

                <div class="tabs">
                    <button class="tab-btn active" onclick="switchInventoryTab('ingredients')">Ingredients</button>
                    <button class="tab-btn" onclick="switchInventoryTab('packaging')">Packaging & Supplies</button>
                </div>

                <div id="tab-ingredients" class="inventory-tab-content">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Item Name</th>
                                <th>Category</th>
                                <th>Current Stock</th>
                                <th>Min Level</th>
                                <th>Last Updated</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="ingredients-table-body">
                            <tr>
                                <td colspan="6" class="empty-cell">Loading...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div id="tab-packaging" class="inventory-tab-content" style="display:none;">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Item Name</th>
                                <th>Category</th>
                                <th>Current Stock</th>
                                <th>Min Level</th>
                                <th>Last Updated</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="packaging-table-body">
                            <tr>
                                <td colspan="6" class="empty-cell">Loading...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Corporate Orders Section -->
            <section id="view-corporate" class="view-section" style="display:none;">
                <div class="section-header">
                    <h2>Corporate & Bulk Orders</h2>
                    <button class="btn-primary" onclick="addMockLead()"><i class="fas fa-plus"></i> Add Lead</button>
                </div>
                <div class="filter-bar">
                    <select id="lead-status-filter">
                        <option value="all">All Leads</option>
                        <option value="new">New</option>
                        <option value="discussion">In Discussion</option>
                        <option value="quote">Quote Sent</option>
                        <option value="confirmed">Confirmed</option>
                    </select>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Company</th>
                            <th>Contact</th>
                            <th>Event Date</th>
                            <th>Guest Count</th>
                            <th>Budget</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="corporate-table-body">
                        <tr>
                            <td colspan="7" class="empty-cell">Loading leads...</td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <!-- Customers Section -->
            <section id="view-customers" class="view-section" style="display:none;">
                <div class="section-header">
                    <h2>Customer Database</h2>
                    <button class="btn-primary" onclick="syncCustomers()"><i class="fas fa-sync"></i> Sync from
                        Orders</button>
                </div>
                <div class="filter-bar">
                    <input type="text" id="customer-search" placeholder="Search by name, phone, or email...">
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Phone</th>
                            <th>Email</th>
                            <th>Total Orders</th>
                            <th>Total Spend</th>
                            <th>Last Order</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="customers-table-body">
                        <tr>
                            <td colspan="7" class="empty-cell">Loading customers...</td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <!-- Settings Section -->
            <section id="view-settings" class="view-section" style="display:none;">
                <h2>Settings & Configuration</h2>
                <div class="settings-grid">
                    <div class="settings-card">
                        <h3>Business Profile</h3>
                        <div class="form-group">
                            <label>Business Name</label>
                            <input type="text" id="setting-business-name" placeholder="Gentleman's Bakehouse">
                        </div>
                        <div class="form-group">
                            <label>Contact Phone</label>
                            <input type="tel" id="setting-phone" placeholder="+91 81054 87345">
                        </div>
                        <div class="form-group">
                            <label>Address</label>
                            <textarea id="setting-address" rows="2" placeholder="Business address"></textarea>
                        </div>
                    </div>

                    <div class="settings-card">
                        <h3>Order & Delivery Settings</h3>
                        <div class="form-group">
                            <label>Standard Prep Time (hours)</label>
                            <input type="number" id="setting-prep-time" placeholder="24">
                        </div>
                        <div class="form-group">
                            <label>Delivery Charge (₹)</label>
                            <input type="number" id="setting-delivery-charge" placeholder="0">
                        </div>
                        <div class="form-group">
                            <label>Delivery Slots</label>
                            <input type="text" id="setting-delivery-slots" placeholder="10am-2pm, 4pm-8pm">
                        </div>
                    </div>

                    <div class="settings-card">
                        <h3>Notifications</h3>
                        <div class="form-group">
                            <label><input type="checkbox" id="setting-notify-order"> Email on New Order</label>
                        </div>
                        <div class="form-group">
                            <label><input type="checkbox" id="setting-notify-lead"> Email on New Lead</label>
                        </div>
                    </div>

                    <div class="settings-card">
                        <h3>Staff Access</h3>
                        <button class="btn-primary" onclick="openUserModal()"><i class="fas fa-user-plus"></i> Add
                            User</button>
                        <table class="data-table" style="margin-top:1rem;">
                            <thead>
                                <tr>
                                    <th>Email</th>
                                    <th>Role</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="users-table-body">
                                <tr>
                                    <td colspan="3" class="empty-cell">Loading...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <button class="btn-primary" onclick="saveSettings()">Save All Settings</button>
            </section>
        </main>
    </div>

    <!-- Modals -->
    <!-- Order Details Modal -->
    <div id="order-modal" class="modal-overlay">
        <div class="modal-container">
            <div class="modal-header">
                <h3 id="modal-order-id">Order Details</h3>
                <button class="close-modal" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="modal-grid">
                    <div class="modal-section">
                        <h4>Customer Info</h4>
                        <p><strong>Name:</strong> <span id="modal-customer-name">-</span></p>
                        <p><strong>Phone:</strong> <span id="modal-customer-phone">-</span></p>
                        <p><strong>Email:</strong> <span id="modal-customer-email">-</span></p>
                        <p><strong>Address:</strong> <span id="modal-customer-address">-</span></p>
                    </div>
                    <div class="modal-section">
                        <h4>Order Status</h4>
                        <select id="modal-status">
                            <option value="pending">Pending</option>
                            <option value="confirmed">Confirmed</option>
                            <option value="production">In Production</option>
                            <option value="dispatched">Dispatched</option>
                            <option value="completed">Completed</option>
                        </select>
                    </div>
                </div>
                <h4 style="margin-top:1.5rem;">Items</h4>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Item</th>
                            <th>Qty</th>
                            <th>Price</th>
                            <th>Total</th>
                        </tr>
                    </thead>
                    <tbody id="modal-items-body"></tbody>
                    <tfoot>
                        <tr>
                            <td colspan="3" style="text-align:right; font-weight:bold;">Grand Total:</td>
                            <td style="font-weight:bold;" id="modal-total-amount">₹0</td>
                        </tr>
                    </tfoot>
                </table>
                <div class="modal-section" style="margin-top:1.5rem;">
                    <label><strong>Order Notes:</strong></label>
                    <p id="modal-notes" style="font-style:italic; color:#666;">-</p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-outline" onclick="closeModal()">Close</button>
                <button class="btn-primary" onclick="saveOrderStatus()">Save Changes</button>
            </div>
        </div>
    </div>

    <!-- Product Modal -->
    <div id="product-modal" class="modal-overlay">
        <div class="modal-container">
            <div class="modal-header">
                <h3 id="product-modal-title">Add Product</h3>
                <button class="close-modal" onclick="closeProductModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Product Name</label>
                    <input type="text" id="product-name" placeholder="e.g. Chocolate Chip Cookies">
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <textarea id="product-description" rows="2"></textarea>
                </div>
                <div class="modal-grid">
                    <div class="form-group">
                        <label>Category</label>
                        <select id="product-category">
                            <option value="Cookies">Cookies</option>
                            <option value="Cakes">Cakes</option>
                            <option value="Breads">Breads</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Price (₹)</label>
                        <input type="number" id="product-price" placeholder="350">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-outline" onclick="closeProductModal()">Cancel</button>
                <button class="btn-primary" onclick="saveProduct()">Save Product</button>
            </div>
        </div>
    </div>

    <!-- Inventory Modal -->
    <div id="inventory-modal" class="modal-overlay">
        <div class="modal-container">
            <div class="modal-header">
                <h3 id="inv-modal-title">Add Item</h3>
                <button class="close-modal" onclick="closeInventoryModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Item Name</label>
                    <input type="text" id="inv-name" placeholder="e.g. Sugar">
                </div>
                <div class="modal-grid">
                    <div class="form-group">
                        <label>Category</label>
                        <input type="text" id="inv-category" placeholder="e.g. Baking Essentials">
                    </div>
                    <div class="form-group">
                        <label>Supplier</label>
                        <input type="text" id="inv-supplier" placeholder="e.g. Metro">
                    </div>
                </div>
                <div class="modal-grid">
                    <div class="form-group">
                        <label>Current Stock</label>
                        <input type="number" id="inv-stock" placeholder="0" step="0.01">
                    </div>
                    <div class="form-group">
                        <label>Unit</label>
                        <select id="inv-unit">
                            <option value="kg">kg</option>
                            <option value="g">g</option>
                            <option value="L">L</option>
                            <option value="pieces">pieces</option>
                            <option value="meters">meters</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>Minimum Level</label>
                    <input type="number" id="inv-min" placeholder="10">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-outline" onclick="closeInventoryModal()">Cancel</button>
                <button class="btn-primary" onclick="saveInventoryItem()">Save Item</button>
            </div>
        </div>
    </div>

    <!-- Lead Details Modal -->
    <div id="lead-modal" class="modal-overlay">
        <div class="modal-container">
            <div class="modal-header">
                <h3 id="lead-modal-title">Lead Details</h3>
                <button class="close-modal" onclick="closeLeadModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="modal-grid">
                    <div class="modal-section">
                        <h4>Company Info</h4>
                        <p><strong>Company:</strong> <span id="lead-company">-</span></p>
                        <p><strong>Contact:</strong> <span id="lead-contact">-</span></p>
                        <p><strong>Email:</strong> <span id="lead-email">-</span></p>
                        <p><strong>Phone:</strong> <span id="lead-phone">-</span></p>
                    </div>
                    <div class="modal-section">
                        <h4>Event Details</h4>
                        <p><strong>Date:</strong> <span id="lead-date">-</span></p>
                        <p><strong>Budget:</strong> <span id="lead-budget">-</span></p>
                        <p><strong>Qty:</strong> <span id="lead-qty">-</span></p>
                    </div>
                </div>
                <div class="modal-section" style="margin-top:1rem;">
                    <h4>Requirements</h4>
                    <p id="lead-message" style="background:#f9f9f9; padding:10px; border-radius:4px;">-</p>
                </div>
                <div class="modal-section" style="margin-top:1rem;">
                    <h4>Internal Notes & Status</h4>
                    <div class="form-group">
                        <label>Status</label>
                        <select id="lead-status">
                            <option value="new">New</option>
                            <option value="discussion">In Discussion</option>
                            <option value="quote">Quote Sent</option>
                            <option value="confirmed">Confirmed</option>
                            <option value="closed">Closed</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Quote Reference</label>
                        <input type="text" id="lead-quote-ref" placeholder="Doc link or Quote #">
                    </div>
                    <div class="form-group">
                        <label>Internal Notes</label>
                        <textarea id="lead-notes" rows="3"></textarea>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-outline" onclick="closeLeadModal()">Close</button>
                <button class="btn-primary" onclick="saveLeadNotes()">Save Updates</button>
            </div>
        </div>
    </div>

    <!-- Customer Modal -->
    <div id="customer-modal" class="modal-overlay">
        <div class="modal-container">
            <div class="modal-header">
                <h3 id="cust-modal-title">Customer Profile</h3>
                <button class="close-modal" onclick="closeCustomerModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="modal-grid">
                    <div class="modal-section">
                        <h4>Contact Info</h4>
                        <p><strong>Name:</strong> <span id="cust-name">-</span></p>
                        <p><strong>Phone:</strong> <span id="cust-phone">-</span></p>
                        <p><strong>Email:</strong> <span id="cust-email">-</span></p>
                        <p><strong>Address:</strong> <span id="cust-address">-</span></p>
                    </div>
                    <div class="modal-section">
                        <h4>Stats</h4>
                        <p><strong>Total Spend:</strong> <span id="cust-spend"
                                style="color:green; font-weight:bold;">-</span></p>
                        <p><strong>Total Orders:</strong> <span id="cust-orders">-</span></p>
                        <p><strong>Last Order:</strong> <span id="cust-last-date">-</span></p>
                    </div>
                </div>
                <div class="modal-section" style="margin-top:1rem;">
                    <h4>Management</h4>
                    <div class="form-group">
                        <label>Tags</label>
                        <input type="text" id="cust-tags" placeholder="VIP, Corporate, etc.">
                    </div>
                    <div class="form-group">
                        <label>Internal Notes</label>
                        <textarea id="cust-notes" rows="2"></textarea>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-outline" onclick="closeCustomerModal()">Close</button>
                <button class="btn-primary" onclick="saveCustomerDetails()">Save Profile</button>
            </div>
        </div>
    </div>

    <!-- User Modal -->
    <div id="user-modal" class="modal-overlay">
        <div class="modal-container" style="max-width:400px;">
            <div class="modal-header">
                <h3>Manage User</h3>
                <button class="close-modal" onclick="closeUserModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Email Address</label>
                    <input type="email" id="user-email" placeholder="staff@example.com">
                </div>
                <div class="form-group">
                    <label>Role</label>
                    <select id="user-role">
                        <option value="Admin">Admin (Full Access)</option>
                        <option value="Kitchen">Kitchen (View Only)</option>
                        <option value="Support">Support (Orders & CRM)</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-outline" onclick="closeUserModal()">Cancel</button>
                <button class="btn-primary" onclick="saveUser()">Save Access</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/firebase-config.js"></script>
    <script src="js/admin.js"></script>
</body>

</html>